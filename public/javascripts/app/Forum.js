/*
 * File: Forum.js
 * Date: Sun Aug 01 2010 23:00:18 GMT-0300 (BRT)
 * 
 * This file was generated by Ext Designer version xds-1.0.2.11.
 * http://www.extjs.com/products/designer/
 *
 * This file will be generated the first time you export.
 *
 * You should implement event handling and custom methods in this
 * class.
 */


ConteudoView = Ext.extend(Ext.Panel, {
    border:false,
     tpl:"<div class='conteudo'><div class='titulo'><div class='data'>data<br />XX comentários</div><strong>{titulo}</strong><br /><em>autor</em></div><p>{texto}</p></div>",
     initComponent: function() {
         console.debug(this.data)
         ConteudoView.superclass.initComponent.call(this);
     }
 });
Ext.reg('conteudoview', ConteudoView);

Forum = Ext.extend(ForumUi, {
    initComponent: function() {
        Forum.superclass.initComponent.call(this);
        
        this.novoTopico.on('click', function() {
            var detalhes = Ext.getCmp('detalhes');
            
            console.debug(detalhes)
            detalhes.removeAll(true);
            
            detalhes.add({
                standardSubmit: false,
                url: '/comunidades/1/forums.json',
                xtype:'form',
                padding:10,
                labelAlign:'top',
                title:'Crie um novo tópico',
                items:[
                    {xtype:'textfield', name:"forum[titulo]", fieldLabel:"Título do tópico"},
                    {xtype:'htmleditor', name:"forum[texto]", fieldLabel:"Descrição",}
                ],
                buttons:[
                    {text:'Salvar', handler: function(){
                        var fp = this.ownerCt.ownerCt,
                            form = fp.getForm();
                        // if (form.isValid()) {
                        form.submit({
                            success: function(form, action) {
                                Ext.StoreMgr.lookup('conteudo').reload();
                                Ext.Msg.alert('Success', action.result.msg);
                            }
                        });
                    }}, {text:'Cancelar'}
                ]
                
            })
            // detalhes.setLayout('fit')
            detalhes.doLayout();
            // alert("criar novo topico")
        })
        
    }
});
Ext.reg('forum', Forum);